{% extends 'base.html' %}
{% block content %}
<div class="container mt-5">
  <a href="{% url 'cashier_dashboard' %}" class="btn btn-primary mt-3 mb-4">‚Üê Back</a>
  <h3 style="color: brown;"><u>Bill for Table </u>: {{ bill.order.table.number }}</h3>
  <p style="color: brown;"><strong>Customer Name:</strong> {{ bill.order.customer.name }}</p>
  <p style="color: brown;"><strong>Customer Mobile:</strong> {{ bill.order.customer.mobile }}</p>
  <p style="color: brown;"><strong>Waiter:</strong> {{ bill.order.waiter.name }}</p>
  <p style="color: brown;"><strong>Date:</strong> {{ bill.generated_at|date:"d M Y H:i A" }}</p>

  <table class="custom-table">
    <thead>
      <tr>
        <th>Item</th>
        <th>Qty</th>
        <th>Price</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody>
      {% for item in bill.order.items.all %}
      <tr>
        <td>{{ item.item.name|title }}</td>
        <td class="text-center">{{ item.quantity }}</td>
        <td class="text-center">${{ item.item.price }}</td>
        <td class="text-center">${{ item.total_price|floatformat:2 }}</td>
      </tr>
      {% endfor %}
      <tr>
        <td colspan="3" class="text-end"><strong>Subtotal:</strong></td>
        <td class="text-center"><strong>${{ bill.total }}</strong></td>
      </tr>
      <tr>
        <td colspan="3" class="text-end">CGST ({{ bill.get_tax_setting.cgst }}%)</td>
        <td class="text-center">${{ bill.cgst_amount|floatformat:2 }}</td>
      </tr>
      <tr>
        <td colspan="3" class="text-end">SGST ({{ bill.get_tax_setting.sgst }}%)</td>
        <td class="text-center">${{ bill.sgst_amount|floatformat:2 }}</td>
      </tr>
      <tr>
        <td colspan="3" class="text-end">Tip:</td>
        <td class="text-center">${{ bill.tip }}</td>
      </tr>
      <tr class="table-success">
        <td colspan="3" class="text-end">Total Due:</td>
        <td class="text-center"><strong>${{ bill.grand_total_with_tax|floatformat:2 }}</strong></td>
      </tr>
    </tbody>
  </table>

  <a href="{% url 'generate_receipt' bill.id %}" target="_blank" class="btn btn-outline-dark mt-4">
    <i class="bi bi-printer"></i> Print Receipt
  </a>
</div>
{% endblock %}