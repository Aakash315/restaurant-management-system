{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container mt-4">
  {% if request.user.is_authenticated %}
  <a href="{% url 'logout' %}" class="btn btn-outline-danger btn-sm">
      <i class="bi bi-box-arrow-right"></i> Logout
  </a>
  {% endif %}
    <h2 class="mb-4">Manager Dashboard</h2>

    <!-- Navigation Links -->
    <div class="mb-4">
        <a href="{% url 'manager_feedback' %}" class="btn btn-outline-primary btn-sm">View Feedback</a>
        <a href="{% url 'manager_report' %}" class="btn btn-outline-success btn-sm">Daily Report</a>
        <a href="{% url 'inventory_dashboard' %}" class="btn btn-outline-warning btn-sm">Inventory</a>
    </div>

    <!-- Tables Overview -->
    <h4>Tables Overview</h4>
    <table class="table table-bordered table-hover">
        <thead class="thead-light">
            <tr>
                <th>Table Number</th>
                <th>Capacity</th>
                <th>Occupied</th>
                <th>Assigned Waiter</th>
                <th>Last Activity</th>
            </tr>
        </thead>
        <tbody>
            {% for table in tables %}
            <tr>
                <td>{{ table.number }}</td>
                <td>{{ table.capacity }}</td>
                <td>
                    {% if table.is_occupied %}
                        <span class="badge bg-danger">Yes</span>
                    {% else %}
                        <span class="badge bg-success">No</span>
                    {% endif %}
                </td>
                <td>
                    {{ table.assigned_waiter.user.username|default:"-" }}
                </td>
                <td>{{ table.last_activity|date:"Y-m-d H:i" }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" class="text-center">No tables found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Recent Orders -->
    <h4 class="mt-5">Recent Orders</h4>
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th>Order ID</th>
                <th>Table</th>
                <th>Customer</th>
                <th>Waiter</th>
                <th>Status</th>
                <th>Created At</th>
            </tr>
        </thead>
        <tbody>
            {% for order in orders %}
            <tr>
                <td>#{{ order.id }}</td>
                <td>{{ order.table.number }}</td>
                <td>{{ order.customer.name }}</td>
                <td>{{ order.waiter.user.username|default:"-" }}</td>
                <td><span class="badge bg-info text-dark">{{ order.status }}</span></td>
                <td>{{ order.created_at|date:"Y-m-d H:i" }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="6" class="text-center">No recent orders.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
