{% extends 'base.html' %}
{% block content %}
<div class="container mt-5">
  <a href="{% url 'manager_dashboard' %}" class="btn btn-success"><i class="bi bi-arrow-left-circle"></i> Back </a>

  <div class="text-center">
  <h3><i class="bi bi-box-seam"></i> Inventory Management</h3>
  </div>

  <h5 class="mt-4" style="color: brown;">📉 Low Stock Alerts</h5>

  {% if low_stock_items %}
  <ul class="list-group">
    {% for item in low_stock_items %}
    <li class="list-group-item d-flex justify-content-between">
      {{ item.name|title }}
      <span class="badge bg-danger">{{ item.stock_quantity }} left</span>
    </li>
    {% endfor %}
  </ul>
  {% else %}
  <p style="color: brown;">No low-stock items 🚀</p>
  {% endif %}

  <hr>

  <!-- 🔍 Search Bar -->
  <form method="get" class="mb-3 d-flex" role="search">
    <input type="text" name="q" placeholder="Search item..." value="{{ query }}" class="form-control me-2" />
    <button type="submit" class="btn btn-success">Search</button>
  </form>

  <h5 class="mt-4 mb-3 text-center" style="color: brown;">📦 Full Inventory</h5>
  <table class="admin-table">
    <thead>
      <tr>
        <th>Item</th>
        <th>Stock</th>
        <th>Threshold</th>
        <th>Update</th>
      </tr>
    </thead>
    <tbody>
      {% for item in items %}
      <tr>
        <td>{{ item.name|title }}</td>
        <td>{{ item.stock_quantity }}</td>
        <td>{{ item.low_stock_threshold }}</td>
        <td>
          <form method="post" action="{% url 'update_stock' item.id %}" class="d-flex">
            {% csrf_token %}
            <input type="number" name="stock_quantity" class="form-control me-2" value="{{ item.stock_quantity }}">
            <button class="btn btn-success">Update</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}